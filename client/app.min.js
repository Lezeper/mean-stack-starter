var app=angular.module("app",["ui.router"]);!function(){app.controller("footerCtrl",["$scope","meanData","$rootScope",function(t,e,n){t.year=(new Date).getFullYear(),e.getSettings().then(function(t){1==t.data.length&&(n.settings=t.data[0])})}]),app.controller("mainCtrl",["$scope","$rootScope",function(t,e){e.prismHighlight=function(){Prism.highlightAll()},e.tinymceUsage={setup:function(t){t.on("keydown",function(e){if(9==e.keyCode)return e.shiftKey?t.execCommand("Outdent"):t.execCommand("Indent"),e.preventDefault(),!1})},height:250,plugins:"link image codesample advlist code preview",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image",valid_elements:"*[*]"},e.$on("onFinishRepeat",function(e){t.prismHighlight()})}]),app.directive("onFinishRepeat",["$timeout",function(t){return{restrict:"A",link:function(e,n,o){e.$last===!0&&t(function(){e.$emit(o.onFinishRepeat)})}}}]),app.directive("subCatCounts",function(){return function(t,e,n){"doc"==t.group&&t.meanData.getDocCountsByCategory(n.subCatCounts).then(function(t){e.html(t.data)}),"que"==t.group&&t.meanData.getQueCountsByCategory(n.subCatCounts).then(function(t){e.html(t.data)})}}),app.run(["$transitions","$state","authentication",function(t,e,n){t.onStart({},function(t){t.$to().name.indexOf("admin")>=0&&(n.isLoggedIn()||e.go("login"))})}])}(),function(){app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,n){t.state("home",{url:"/",templateUrl:"/home/home.view.html",controller:"homeCtrl"}).state("login",{url:"/login",templateUrl:"/auth/auth.view.html",controller:"loginCtrl"}).state("admin",{url:"/admin/",templateUrl:"/admin/admin.view.html",controller:"adminCtrl"}).state("admin.overviews",{url:"overviews/",templateUrl:"/admin/overviews/overviews.view.html",controller:"overviewsCtrl"}).state("admin.userm",{url:"userm/",templateUrl:"/admin/userm/userm.view.html",controller:"usermCtrl"}).state("admin.log",{url:"log/",templateUrl:"/admin/log/log.view.html",controller:"logCtrl"}).state("admin.settings",{url:"settings/",templateUrl:"/admin/settings/settings.view.html",controller:"settingsCtrl"}),n.otherwise("/"),e.html5Mode(!0)}])}(),function(){app.controller("adminCtrl",["$scope",function(t){}])}(),function(){app.controller("homeCtrl",["$scope",function(t){}])}(),function(){app.controller("loginCtrl",["$scope","authentication","meanData",function(t,e,n){t.error=!1,t.login=function(n){e.login(n).then(function(){window.location.href="/"},function(){t.error=!0})},t.register=function(t){n.createUser(t).then(function(t){alert(t.message),window.location.href="/"})}}])}(),function(){app.controller("overviewsCtrl",["$scope","meanData",function(t,e){}])}(),function(){app.controller("logCtrl",["$scope","meanData","$state",function(t,e,n){t.findAllLogs=function(){e.getAllLogs().then(function(e){t.logs=e.data})},t.deleteAllLogs=function(){e.deleteAllLogs().then(function(t){alert(t.data.message),n.reload()})}}])}(),function(){app.controller("settingsCtrl",["$scope","meanData","$state",function(t,e,n){t.backupDB=function(){e.doDBBackup().then(function(t){alert(t.data.message),n.reload()})},t.getSettings=function(){e.getSettings().then(function(e){e.length>1?alert("More than one settings found!"):t.settings=e.data[0]})},t.updateSettings=function(t){e.updateSettings(t).then(function(t){alert(t.data.message),window.location.href="/admin/settings"})},t.deleteSettings=function(){e.deleteSettings().then(function(t){alert(t.data.message)})}}])}(),function(){app.controller("usermCtrl",["$scope","meanData","$state",function(t,e,n){e.getAllUsers().then(function(e){t.users=e.data}),t.deleteUser=function(t){confirm("Are you sure to delete?")&&e.deleteUser(t).then(function(t){alert(t.data.message),n.reload()})}}])}(),function(){app.service("authentication",["$http","$window",function(t,e){var n=function(t){e.localStorage["mean-token"]=t},o=function(){return e.localStorage["mean-token"]},i=function(){var t,n=o();return!!n&&(t=n.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3)},r=function(){if(i()){var t=o(),n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{_id:n._id,name:n.name}}},a=function(e){return t.post("/api/login",e).then(function(t){n(t.data.token)})},l=function(){e.localStorage.removeItem("mean-token")};return{login:a,isLoggedIn:i,currentUser:r,logout:l,getToken:o}}])}(),function(){app.service("meanData",["$http","authentication",function(t,e){var n="/api",o={headers:{Authorization:"Bearer "+e.getToken()}},i=function(){return t.get(n+"/user",o)},r=function(e){return t.get(n+"/user/"+e,o)},a=function(e){return t.post(n+"/user",e)},l=function(e){return t.put(n+"/user",e,o)},u=function(e){return t["delete"](n+"/user?id="+e,o)},s=function(){return t.get(n+"/log",o)},c=function(e){return t.get(n+"/log?ip="+e,o)},g=function(e){return t.get(n+"/log?date="+e,o)},f=function(){return t["delete"](n+"/log",o)},p=function(){return t.get(n+"/settings",o)},d=function(){return t.get(n+"/settings/dbbu",o)},m=function(e){return t.put(n+"/settings",e,o)},h=function(){return t["delete"](n+"/settings",o)};return{getAllUsers:i,createUser:a,updateUser:l,deleteUser:u,getUserById:r,getSettings:p,doDBBackup:d,updateSettings:m,deleteSettings:h,getAllLogs:s,getLogsByIp:c,getLogsByDate:g,deleteAllLogs:f}}])}(),function(){app.directive("navigation",function(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.view.html"}}),app.controller("navCtrl",["$scope","$location","authentication","$state","$window","$rootScope",function(t,e,n,o,i,r){t.logout=function(){n.logout(),i.location.href="/"},t.currentUser=n.currentUser(),t.isLoggedIn=n.isLoggedIn(),r.isActive=function(t){return"/"===t?e.path()===t:e.path().indexOf(t)>=0}}])}();
//# sourceMappingURL=app.min.js.map
