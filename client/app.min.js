var app=angular.module("app",["ui.router"]);!function(){app.controller("footerCtrl",["$scope","meanData","$rootScope",function(t,e,n){t.year=(new Date).getFullYear(),e.getSettings().then(function(t){1==t.data.length&&(n.settings=t.data[0])})}]),app.controller("mainCtrl",["$scope","$rootScope",function(t,e){e.prismHighlight=function(){Prism.highlightAll()},e.tinymceUsage={setup:function(t){t.on("keydown",function(e){if(9==e.keyCode)return e.shiftKey?t.execCommand("Outdent"):t.execCommand("Indent"),e.preventDefault(),!1})},height:250,plugins:"link image codesample advlist code preview",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image",valid_elements:"*[*]"},e.$on("onFinishRepeat",function(e){t.prismHighlight()})}]),app.directive("onFinishRepeat",["$timeout",function(t){return{restrict:"A",link:function(e,n,o){e.$last===!0&&t(function(){e.$emit(o.onFinishRepeat)})}}}]),app.directive("subCatCounts",function(){return function(t,e,n){"doc"==t.group&&t.meanData.getDocCountsByCategory(n.subCatCounts).then(function(t){e.html(t.data)}),"que"==t.group&&t.meanData.getQueCountsByCategory(n.subCatCounts).then(function(t){e.html(t.data)})}}),app.run(["$transitions","$state","authentication",function(t,e,n){t.onStart({},function(t){t.$to().name.indexOf("admin")>=0&&(n.isLoggedIn()||e.go("login"))})}])}(),function(){app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,n){t.state("home",{url:"/",templateUrl:"/home/home.view.html",controller:"homeCtrl"}).state("login",{url:"/login",templateUrl:"/auth/auth.view.html",controller:"loginCtrl"}).state("admin",{url:"/admin/",templateUrl:"/admin/admin.view.html",controller:"adminCtrl"}).state("admin.overviews",{url:"overviews/",templateUrl:"/admin/overviews/overviews.view.html",controller:"overviewsCtrl"}).state("admin.userm",{url:"userm/",templateUrl:"/admin/userm/userm.view.html",controller:"usermCtrl"}).state("admin.mg",{url:"mg/",templateUrl:"/admin/mg/mg.view.html",controller:"mgCtrl"}).state("admin.module",{url:"module/",templateUrl:"/admin/module/module.view.html",controller:"moduleCtrl"}).state("admin.log",{url:"log/",templateUrl:"/admin/log/log.view.html",controller:"logCtrl"}).state("test",{url:"/test/",templateUrl:"/test/test.view.html",controller:"testCtrl"}).state("admin.settings",{url:"settings/",templateUrl:"/admin/settings/settings.view.html",controller:"settingsCtrl"}),n.otherwise("/"),e.html5Mode(!0)}])}(),function(){app.controller("adminCtrl",["$scope",function(t){}])}(),function(){app.controller("loginCtrl",["$scope","authentication","meanData",function(t,e,n){t.error=!1,t.login=function(n){e.login(n).error(function(){t.error=!0}).then(function(){window.location.href="/"})},t.register=function(t){n.createUser(t).success(function(t){alert(t.message),window.location.href="/"})}}])}(),function(){app.controller("homeCtrl",["$scope",function(t){}])}(),function(){app.controller("testCtrl",["$scope","meanData",function(t,e){t.getAllTest=function(){return new Promise(function(t,n){e.getAllTest().then(function(e){t(e.data)},function(t){alert(t.data.errmsg),n()})})},t.getTestById=function(){return new Promise(function(t,n){e.getTestById().then(function(e){t(e.data)},function(t){alert(t.data.errmsg),n()})})},t.createTest=function(t){return new Promise(function(n,o){e.createTest(t).then(function(t){alert(t.data.message),n(t.data.id)},function(t){alert(t.data.errmsg),o(t.data.errmsg)})})},t.updateTest=function(t){return new Promise(function(n,o){e.updateTest(t).then(function(t){alert(t.data.message),n()},function(t){alert(t.data.errmsg),o()})})},t.deleteTestById=function(t){return new Promise(function(n,o){e.deleteTestById(t).then(function(t){alert(t.data.message),n()},function(t){alert(t.data.errmsg),o()})})}}])}(),function(){app.controller("logCtrl",["$scope","meanData","$state",function(t,e,n){t.findAllLogs=function(){e.getAllLogs().then(function(e){t.logs=e.data})},t.deleteAllLogs=function(){e.deleteAllLogs().then(function(t){alert(t.data.message),n.reload()})}}])}(),function(){app.controller("mgCtrl",["$scope","meanData",function(t,e){t.number=1,t.getNumber=function(t){return new Array(t)},t.changeFUrl=function(t){t.frontUrl="/"+t.moduleName.toLowerCase()},t.addProp=function(e){e<0&&t.number<=1||(t.number=t.number+e)},t.doGenerate=function(t){e.createModuleModel(t).then(function(t){alert(t.data.message||t.data),window.location.href="/admin/module/"},function(t){alert(t.data)})}}])}(),function(){app.controller("moduleCtrl",["$scope","$controller","meanData","$state",function(t,e,n,o){t.getAllModuleModel=function(){n.getAllModuleModel().then(function(e){t.module_model=e.data})},t.deleteModuleModel=function(t,e){n.deleteModuleModelById(t,e).then(function(t){alert(t.data.message),o.reload()},function(t){alert(t.data)})};var r=function(t,e){t.checked=!1,e.$digest()};t.testModule=function(n,o){var i={},a={};o.required_p.forEach(function(t){Object.keys(t).forEach(function(e){"String"==t[e]&&(i[e]="Lewis",a[e]="Lewis1"),"Number"==t[e]&&(i[e]=123,a[e]=1231),"Array"==t[e]&&(i[e]=[{name:"Test"}],a[e]=[{name:"Test1"}]),"Date"==t[e]&&(i[e]=new Date,a[e]=new Date),"Boolean"==t[e]&&(i[e]=!0,a[e]=!1)})});var l=t.$new();module_name=n.toLowerCase(),e(module_name+"Ctrl",{$scope:l}),console.log(i),l["create"+n](i).then(function(e){l["getAll"+n]().then(function(i){return 0==i.length?r(o,t):void l["update"+n](a).then(function(){l["get"+n+"ById"](e).then(function(i){l["delete"+n+"ById"](e).then(function(){o.checked=!0,t.$digest()},function(e){r(o,t)})},function(e){r(o,t)})},function(e){r(o,t)})},function(e){r(o,t)})},function(e){r(o,t)})}}])}(),function(){app.controller("overviewsCtrl",["$scope","meanData",function(t,e){}])}(),function(){app.controller("usermCtrl",["$scope","meanData","$state",function(t,e,n){e.getAllUsers().then(function(e){t.users=e.data}),t.deleteUser=function(t){confirm("Are you sure to delete?")&&e.deleteUser(t).then(function(t){alert(t.data.message),n.reload()})}}])}(),function(){app.controller("settingsCtrl",["$scope","meanData","$state",function(t,e,n){t.backupDB=function(){e.doDBBackup().then(function(t){alert(t.data.message),n.reload()})},t.getSettings=function(){e.getSettings().then(function(e){e.length>1?alert("More than one settings found!"):t.settings=e.data[0]})},t.updateSettings=function(t){e.updateSettings(t).then(function(t){alert(t.data.message),window.location.href="/admin/settings"})},t.deleteSettings=function(){e.deleteSettings().then(function(t){alert(t.data.message)})}}])}(),function(){app.service("authentication",["$http","$window",function(t,e){var n=function(t){e.localStorage["mean-token"]=t},o=function(){return e.localStorage["mean-token"]},r=function(){var t,n=o();return!!n&&(t=n.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3)},i=function(){if(r()){var t=o(),n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{_id:n._id,name:n.name}}},a=function(e){return t.post("/api/login",e).success(function(t){n(t.token)})},l=function(){e.localStorage.removeItem("mean-token")};return{login:a,isLoggedIn:r,currentUser:i,logout:l,getToken:o}}])}(),function(){app.service("meanData",["$http","authentication",function(t,e){var n="/api",o={headers:{Authorization:"Bearer "+e.getToken()}},r=function(){return t.get(n+"/user",o)},i=function(e){return t.get(n+"/user/"+e,o)},a=function(e){return t.post(n+"/user",e)},l=function(e){return t.put(n+"/user",e,o)},u=function(e){return t["delete"](n+"/user?id="+e,o)},c=function(){return t.get(n+"/log",o)},s=function(e){return t.get(n+"/log?ip="+e,o)},d=function(e){return t.get(n+"/log?date="+e,o)},f=function(){return t["delete"](n+"/log",o)},g=function(){return t.get(n+"/settings",o)},m=function(){return t.get(n+"/settings/dbbu",o)},p=function(e){return t.put(n+"/settings",e,o)},h=function(){return t["delete"](n+"/settings",o)},v=function(){return t.get(n+"/mm",o)},w=function(e){return t.post(n+"/mm",e,o)},$=function(e){return t.put(n+"/mm",e,o)},C=function(e,r){return t["delete"](n+"/mm?id="+e+"&moduleName="+r,o)},y=function(){return t.get(n+"/test")},U=function(e){return t.get(n+"/test?id="+e)},A=function(e){return t.post(n+"/test",e)},D=function(e){return t.put(n+"/test",e)},B=function(e){return t["delete"](n+"/test?id="+e)};return{getAllUsers:r,createUser:a,updateUser:l,deleteUser:u,getUserById:i,getSettings:g,doDBBackup:m,updateSettings:p,deleteSettings:h,getAllLogs:c,getLogsByIp:s,getLogsByDate:d,deleteAllLogs:f,getAllModuleModel:v,createModuleModel:w,updateModuleModel:$,deleteModuleModelById:C,getAllTest:y,getTestById:U,createTest:A,updateTest:D,deleteTestById:B}}])}(),function(){app.directive("navigation",function(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.view.html"}}),app.controller("navCtrl",["$scope","$location","authentication","$state","$window","$rootScope",function(t,e,n,o,r,i){t.logout=function(){n.logout(),r.location.href="/"},t.currentUser=n.currentUser(),t.isLoggedIn=n.isLoggedIn(),i.isActive=function(t){return"/"===t?e.path()===t:e.path().indexOf(t)>=0}}])}();
//# sourceMappingURL=app.min.js.map
