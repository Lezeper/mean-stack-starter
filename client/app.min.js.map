{"version":3,"sources":["app.min.js"],"names":["angular","module","config","$routeProvider","$locationProvider","when","templateUrl","controller","otherwise","redirectTo","html5Mode","enabled","requireBase","$scope","year","Date","getFullYear","authentication","meanData","error","login","user","then","window","location","href","register","cUser","createUser","success","res","alert","message","isLogin","isLoggedIn","currentUser","getUserById","_id","data","logout","updateUser","service","$http","$window","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","now","post","removeItem","getAllUsers","get","id","newUser","put","deleteUser","directive","restrict"],"mappings":"CAAA,WACEA,QAAQC,OAAO,OAAQ,YAAYC,QAAQ,iBAAkB,oBAC3D,SAAUC,EAAgBC,GACxBD,EACGE,KAAK,KACJC,YAAa,uBACbC,WAAY,aAEbF,KAAK,UACJC,YAAa,uBACbC,WAAY,cAEbC,WAAWC,WAAY,MAE1BL,EAAkBM,WAChBC,SAAS,EACTC,aAAa,OAEfL,WAAW,cAAe,SAAU,SAAUM,GAChDA,EAAOC,MAAO,GAAIC,OAAOC,oBAG7B,WACEhB,QAAQC,OAAO,OACZM,WAAW,aAAc,SAAU,iBAAkB,WACpD,SAAUM,EAAQI,EAAgBC,GAElCL,EAAOM,OAAQ,EAEfN,EAAOO,MAAQ,SAAUC,GACvBJ,EAAeG,MAAMC,GAClBF,MAAM,WACLN,EAAOM,OAAQ,IAEhBG,KAAK,WACJC,OAAOC,SAASC,KAAO,OAI7BZ,EAAOa,SAAW,SAAUC,GAC1BT,EAASU,WAAWD,GAAOE,QAAQ,SAAUC,GAC3CC,MAAMD,EAAIE,SACVT,OAAOC,SAASC,KAAO,aAMjC,WACEzB,QAAQC,OAAO,OAAOM,WAAW,YAAa,SAAU,WAAY,iBAClE,SAAUM,EAAQK,EAAUD,GAE1BJ,EAAOoB,QAAUhB,EAAeiB,aAE7BjB,EAAekB,eAChBjB,EAASkB,YAAYnB,EAAekB,cAAcE,KAAKR,QAAQ,SAAUS,GACvEzB,EAAOsB,YAAcG,IAIzBzB,EAAO0B,OAAS,WACdtB,EAAesB,SACfhB,OAAOC,SAASC,KAAO,KAGzBZ,EAAO2B,WAAa,WAClBtB,EAASsB,WAAW3B,EAAOsB,aAAaN,QAAQ,SAAUC,GACxDC,MAAMD,EAAIE,SACVT,OAAOC,SAASC,KAAO,aAMjC,WACEzB,QAAQC,OAAO,OAAOwC,QAAQ,kBAAmB,QAAS,UAAW,WAAY,SAAUC,EAAOC,EAASzB,GAEzG,GAAI0B,GAAY,SAAUC,GACxBF,EAAQG,aAAa,cAAgBD,GAGnCE,EAAW,WACb,MAAOJ,GAAQG,aAAa,eAG1BZ,EAAa,WACf,GACIc,GADAH,EAAQE,GAGZ,SAAGF,IACDG,EAAUH,EAAMI,MAAM,KAAK,GAC3BD,EAAUL,EAAQO,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,GAEdA,EAAQK,IAAMtC,KAAKuC,MAAQ,MAMlCnB,EAAc,WAChB,GAAGD,IAAa,CACd,GAAIW,GAAQE,IACRC,EAAUH,EAAMI,MAAM,KAAK,EAI/B,OAHAD,GAAUL,EAAQO,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,IAGnBX,IAAMW,EAAQX,OAKhBjB,EAAQ,SAAUC,GACpB,MAAOqB,GAAMa,KAAK,aAAclC,GAAMQ,QAAQ,SAAUS,GACtDM,EAAUN,EAAKO,UAIfN,EAAS,WACXI,EAAQG,aAAaU,WAAW,cAGlC,QACEpC,MAAOA,EACPc,WAAYA,EACZC,YAAaA,EACbI,OAAQA,SAMd,WACEvC,QAAQC,OAAO,OAAOwC,QAAQ,YAAa,QAAS,SAAkBC,GAEpE,GAAIe,GAAc,WAChB,MAAOf,GAAMgB,IAAI,cAGftB,EAAc,SAAUuB,GAC1B,MAAOjB,GAAMgB,IAAI,aAAeC,IAG9B/B,EAAa,SAAUgC,GACzB,MAAOlB,GAAMa,KAAK,YAAaK,IAG7BpB,EAAa,SAAUA,GACzB,MAAOE,GAAMmB,IAAI,YAAarB,OAG5BsB,EAAa,SAAUH,GACzB,MAAOjB,GAAAA,UAAa,gBAAkBiB,MAGxC,QACEF,YAAaA,EACb7B,WAAYA,EACZY,WAAYA,EACZsB,WAAYA,EACZ1B,YAAaA,SAInB,WACEpC,QAAQC,OAAO,OAAO8D,UAAU,aAAc,WAC5C,OACEC,SAAU,KACV1D,YAAa","file":"app.min.js","sourcesContent":["(function () {\r\n  angular.module('app', ['ngRoute']).config(['$routeProvider', '$locationProvider',\r\n    function ($routeProvider, $locationProvider) {\r\n      $routeProvider\r\n        .when('/', {\r\n          templateUrl: '/test/test.view.html',\r\n          controller: \"testCtrl\"\r\n        })\r\n        .when('/login', {\r\n          templateUrl: \"/auth/auth.view.html\",\r\n          controller: \"loginCtrl\"\r\n        })\r\n        .otherwise({redirectTo: '/'});\r\n\r\n      $locationProvider.html5Mode({\r\n        enabled: true,\r\n        requireBase: false\r\n      });\r\n  }]).controller('footerCtrl', ['$scope', function ($scope) {\r\n    $scope.year = new Date().getFullYear();\r\n  }])\r\n})();\n(function () {\r\n  angular.module('app')\r\n    .controller('loginCtrl', ['$scope', 'authentication', 'meanData', \r\n      function ($scope, authentication, meanData) {\r\n\r\n      $scope.error = false;\r\n\r\n      $scope.login = function (user) {\r\n        authentication.login(user)\r\n          .error(function () {\r\n            $scope.error = true;\r\n          })\r\n          .then(function () {\r\n            window.location.href = \"/\";\r\n          })\r\n      };\r\n\r\n      $scope.register = function (cUser) {\r\n        meanData.createUser(cUser).success(function (res) {\r\n          alert(res.message);\r\n          window.location.href = \"/\";\r\n        })\r\n      };\r\n\r\n    }])\r\n})();\n(function () {\r\n  angular.module('app').controller('testCtrl', ['$scope', 'meanData', 'authentication',\r\n    function ($scope, meanData, authentication) {\r\n\r\n      $scope.isLogin = authentication.isLoggedIn();\r\n\r\n      if(authentication.currentUser()){\r\n        meanData.getUserById(authentication.currentUser()._id).success(function (data) {\r\n          $scope.currentUser = data;\r\n        });\r\n      }\r\n\r\n      $scope.logout = function () {\r\n        authentication.logout();\r\n        window.location.href = \"/\";\r\n      }\r\n\r\n      $scope.updateUser = function () {\r\n        meanData.updateUser($scope.currentUser).success(function (res) {\r\n          alert(res.message);\r\n          window.location.href = \"/\";\r\n        });\r\n      };\r\n\r\n    }]);\r\n})();\n(function () {\r\n  angular.module('app').service('authentication', ['$http', '$window', 'meanData', function ($http, $window, meanData) {\r\n\r\n    var saveToken = function (token) {\r\n      $window.localStorage['mean-token'] = token;\r\n    };\r\n\r\n    var getToken = function () {\r\n      return $window.localStorage['mean-token'];\r\n    };\r\n\r\n    var isLoggedIn = function () {\r\n      var token = getToken();\r\n      var payload;\r\n\r\n      if(token){\r\n        payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n\r\n        return payload.exp > Date.now() / 1000;\r\n      }else{\r\n        return false;\r\n      }\r\n    };\r\n\r\n    var currentUser = function() {\r\n      if(isLoggedIn()){\r\n        var token = getToken();\r\n        var payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n        \r\n        return {\r\n          _id : payload._id\r\n        };\r\n      }\r\n    };\r\n\r\n    var login = function (user) {\r\n      return $http.post('/api/login', user).success(function (data) {\r\n        saveToken(data.token);\r\n      })\r\n    };\r\n\r\n    var logout = function () {\r\n      $window.localStorage.removeItem('mean-token');\r\n    };\r\n\r\n    return {\r\n      login: login,\r\n      isLoggedIn: isLoggedIn,\r\n      currentUser: currentUser,\r\n      logout: logout\r\n    }\r\n\r\n  }])\r\n  \r\n})();\n(function () {\r\n  angular.module('app').service('meanData', ['$http', function meanData($http) {\r\n\r\n    var getAllUsers = function () {\r\n      return $http.get('/api/user');\r\n    };\r\n\r\n    var getUserById = function (id) {\r\n      return $http.get('/api/user/' + id);\r\n    };\r\n\r\n    var createUser = function (newUser) {\r\n      return $http.post('/api/user', newUser);\r\n    };\r\n\r\n    var updateUser = function (updateUser) {\r\n      return $http.put('/api/user', updateUser, {});\r\n    };\r\n\r\n    var deleteUser = function (id) {\r\n      return $http.delete('/api/user?id=' + id, {});\r\n    };\r\n\r\n    return {\r\n      getAllUsers: getAllUsers,\r\n      createUser: createUser,\r\n      updateUser: updateUser,\r\n      deleteUser: deleteUser,\r\n      getUserById: getUserById\r\n    }\r\n  }])\r\n})();\n(function () {\r\n  angular.module('app').directive('navigation', function () {\r\n    return {\r\n      restrict: 'EA',\r\n      templateUrl: '/common/directives/navigation/navigation.view.html'\r\n    }\r\n  })\r\n})();"]}