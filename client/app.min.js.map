{"version":3,"sources":["app.min.js"],"names":["app","angular","module","controller","$scope","meanData","$rootScope","year","Date","getFullYear","getSettings","then","res","data","length","settings","prismHighlight","Prism","highlightAll","tinymceUsage","setup","editor","on","event","keyCode","shiftKey","execCommand","preventDefault","height","plugins","toolbar","valid_elements","$on","evt","directive","$timeout","restrict","link","scope","element","attr","$last","$emit","onFinishRepeat","attrs","group","getDocCountsByCategory","subCatCounts","result","html","getQueCountsByCategory","run","$transitions","$state","authentication","onStart","$to","name","indexOf","isLoggedIn","go","config","$stateProvider","$locationProvider","$urlRouterProvider","state","url","templateUrl","otherwise","html5Mode","error","login","user","window","location","href","register","cUser","createUser","alert","message","accounts","id","dueDate","closingDate","CL","balance","lastBalance","allowRatio","activities","date","type","amount","account","notes","findAllLogs","getAllLogs","logs","deleteAllLogs","reload","backupDB","doDBBackup","updateSettings","deleteSettings","getAllUsers","users","deleteUser","confirm","service","$http","$window","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","now","currentUser","_id","post","logout","removeItem","serverUrl","auth","headers","Authorization","get","getUserById","newUser","updateUser","put","getLogsByIp","ip","getLogsByDate","$location","isActive","viewLocation","path"],"mappings":"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","file":"app.min.js","sourcesContent":["var app = angular.module('app', ['ui.router']);\r\n(function () {\r\n  app.controller('footerCtrl', ['$scope', 'meanData', '$rootScope',\r\n        function ($scope, meanData, $rootScope) {\r\n    $scope.year = new Date().getFullYear();\r\n    meanData.getSettings().then(function(res){\r\n      if(res.data.length == 1){\r\n        $rootScope.settings = res.data[0];\r\n      }\r\n    }); \r\n  }]);\r\n\r\n  app.controller('mainCtrl', ['$scope', '$rootScope', function($scope, $rootScope){\r\n    $rootScope.prismHighlight = function(){\r\n      Prism.highlightAll();\r\n    };\r\n\r\n    $rootScope.tinymceUsage = {\r\n\t  setup: function(editor){\r\n\t\t  editor.on('keydown', function(event){\r\n\t\t\t if(event.keyCode == 9){\r\n\t\t\t\t if(event.shiftKey){\r\n\t\t\t\t\t editor.execCommand('Outdent');\r\n\t\t\t\t }else{\r\n\t\t\t\t\t editor.execCommand('Indent');\r\n\t\t\t\t }\r\n\t\t\t\t event.preventDefault();\r\n\t\t\t\t return false;\r\n\t\t\t } \r\n\t\t  });\r\n\t  },\r\n      height: 250,\r\n      plugins: 'link image codesample advlist code preview',\r\n      toolbar: 'undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image',\r\n      valid_elements : '*[*]'\r\n    };\r\n    $rootScope.$on('onFinishRepeat', function(evt){\r\n      $scope.prismHighlight();\r\n    });\r\n    \r\n  }]);\r\n\r\n  app.directive('onFinishRepeat', ['$timeout', function($timeout){\r\n    return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attr){\r\n        if(scope.$last === true){\r\n          $timeout(function(){\r\n            scope.$emit(attr.onFinishRepeat);\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }]);\r\n\r\n  app.directive('subCatCounts', function(){\r\n    return function(scope, element, attrs){\r\n      if(scope.group == 'doc'){\r\n        scope.meanData.getDocCountsByCategory(attrs.subCatCounts)\r\n                          .then(function(result){\r\n          element.html(result.data);\r\n        });\r\n      }\r\n      if(scope.group == 'que'){\r\n        scope.meanData.getQueCountsByCategory(attrs.subCatCounts)\r\n                          .then(function(result){\r\n          element.html(result.data);\r\n        });\r\n      }\r\n    };\r\n  });\r\n\r\n  app.run(['$transitions', '$state', 'authentication', \r\n          function($transitions, $state, authentication){\r\n    $transitions.onStart({}, function($transitions){\r\n\r\n      if($transitions.$to().name.indexOf('admin') >= 0){\r\n        if(!authentication.isLoggedIn())\r\n          $state.go('login');\r\n      }\r\n      \r\n    });\r\n  }]);\r\n})();\n(function(){\r\n\tapp.config(['$stateProvider', '$locationProvider', '$urlRouterProvider',\r\n    function ($stateProvider, $locationProvider, $urlRouterProvider) {\r\n      $stateProvider\r\n        .state('home', {\r\n          url: '/',\r\n          templateUrl: '/home/home.view.html',\r\n          controller: \"homeCtrl\"\r\n        })\r\n        .state('login', {\r\n          url: '/login', // can't named \"auth\"\r\n          templateUrl: \"/auth/auth.view.html\",\r\n          controller: \"loginCtrl\"\r\n        })\r\n        .state('admin', {\r\n          url: '/admin/',\r\n          templateUrl: \"/admin/admin.view.html\",\r\n          controller: \"adminCtrl\"\r\n        })\r\n        .state('admin.overviews', {\r\n          url: 'overviews/',\r\n          templateUrl: \"/admin/overviews/overviews.view.html\",\r\n          controller: \"overviewsCtrl\"\r\n        })\r\n        .state('admin.userm', {\r\n          url: 'userm/',\r\n          templateUrl: \"/admin/userm/userm.view.html\",\r\n          controller: \"usermCtrl\"\r\n        })\r\n        .state('admin.log', {\r\n          url: 'log/',\r\n          templateUrl: \"/admin/log/log.view.html\",\r\n          controller: \"logCtrl\"\r\n        })\r\n        .state('admin.settings', {\r\n          url: 'settings/',\r\n          templateUrl: \"/admin/settings/settings.view.html\",\r\n          controller: \"settingsCtrl\"\r\n        });\r\n\r\n        $urlRouterProvider.otherwise('/');\r\n\r\n      $locationProvider.html5Mode(true);\r\n\r\n  }]);\r\n})();\n(function(){\r\n\tapp.controller('adminCtrl', [\"$scope\", function($scope){\r\n\t\t\r\n\t}])\r\n})();\n(function () {\r\n  app.controller('loginCtrl', ['$scope', 'authentication', 'meanData', \r\n      function ($scope, authentication, meanData) {\r\n\r\n      $scope.error = false;\r\n\r\n      $scope.login = function (user) {\r\n        authentication.login(user)\r\n          .then(function () {\r\n            window.location.href = \"/\";\r\n          }, function(){\r\n            $scope.error = true;\r\n          })\r\n      };\r\n\r\n      $scope.register = function (cUser) {\r\n        meanData.createUser(cUser).then(function (res) {\r\n          alert(res.message);\r\n          window.location.href = \"/\";\r\n        })\r\n      };\r\n\r\n    }])\r\n})();\n(function(){\r\n\tapp.controller('homeCtrl', ['$scope', function($scope){\r\n\t// type: Credit, Debit\r\n\t// comsumer: date, type, amount, account, notes\r\n\t// account: id, name, dueDate, closingDate, CL, balance, lastBalance, allow%\r\n\t\t$scope.accounts = [\r\n\t\t\t{\r\n\t\t\t\t\"id\": 000,\r\n\t\t\t\t\"name\": \"Citi Check\",\r\n\t\t\t\t\"dueDate\": 0,\r\n\t\t\t\t\"closingDate\": 0,\r\n\t\t\t\t\"CL\": 0,\r\n\t\t\t\t\"balance\": 295,\r\n\t\t\t\t\"lastBalance\": 0,\r\n\t\t\t\t\"allowRatio\": 0\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"id\": 001,\r\n\t\t\t\t\"name\": \"DC\",\r\n\t\t\t\t\"dueDate\": 14,\r\n\t\t\t\t\"closingDate\": 16,\r\n\t\t\t\t\"CL\": 3500,\r\n\t\t\t\t\"balance\": 202,\r\n\t\t\t\t\"lastBalance\": 100,\r\n\t\t\t\t\"allowRatio\": 3\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"id\": 002,\r\n\t\t\t\t\"name\": \"Freedom\",\r\n\t\t\t\t\"dueDate\": 10,\r\n\t\t\t\t\"closingDate\": 13,\r\n\t\t\t\t\"CL\": 7000,\r\n\t\t\t\t\"balance\": 467,\r\n\t\t\t\t\"lastBalance\": 0,\r\n\t\t\t\t\"allowRatio\": 4\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"id\": 003,\r\n\t\t\t\t\"name\": \"Amazon\",\r\n\t\t\t\t\"dueDate\": 27,\r\n\t\t\t\t\"closingDate\": 3,\r\n\t\t\t\t\"CL\": 6000,\r\n\t\t\t\t\"balance\": 168,\r\n\t\t\t\t\"lastBalance\": 260,\r\n\t\t\t\t\"allowRatio\": 5\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\t$scope.activities = [\r\n\t\t\t{\r\n\t\t\t\t\"date\": \"2/24/2017\",\r\n\t\t\t\t\"type\": \"Credit\",\r\n\t\t\t\t\"amount\": 1735.33,\r\n\t\t\t\t\"account\": \"Citi Check\",\r\n\t\t\t\t\"notes\": \"Salary Direct Deposit\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"date\": \"2/27/2017\",\r\n\t\t\t\t\"type\": \"Debit\",\r\n\t\t\t\t\"amount\": 15,\r\n\t\t\t\t\"account\": \"DC\",\r\n\t\t\t\t\"notes\": \"Dreamhost Fee\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"date\": \"2/28/2017\",\r\n\t\t\t\t\"type\": \"Debit\",\r\n\t\t\t\t\"amount\": 500,\r\n\t\t\t\t\"account\": \"DC\",\r\n\t\t\t\t\"notes\": \"Honda Financial Serivce\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"date\": \"3/1/2017\",\r\n\t\t\t\t\"type\": \"Debit\",\r\n\t\t\t\t\"amount\": 1350,\r\n\t\t\t\t\"account\": \"Citi Check\",\r\n\t\t\t\t\"notes\": \"Hosing Rent\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"date\": \"3/14/2017\",\r\n\t\t\t\t\"type\": \"Credit\",\r\n\t\t\t\t\"amount\": 202,\r\n\t\t\t\t\"account\": \"Citi Check\",\r\n\t\t\t\t\"notes\": \"CC Payment\"\r\n\t\t\t}\r\n\t\t];\r\n\t}]);\r\n})();\n(function(){\r\n\tapp.controller('logCtrl', ['$scope', 'meanData', \r\n\t\t'$state', function($scope, meanData, $state){\r\n\r\n\t\t$scope.findAllLogs = function(){\r\n\t\t\tmeanData.getAllLogs().then(function(data){\r\n\t\t\t\t$scope.logs = data.data;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$scope.deleteAllLogs = function(){\r\n\t\t\tmeanData.deleteAllLogs().then(function(res){\r\n\t\t\t\talert(res.data.message);\r\n\t\t\t\t$state.reload();\r\n\t\t\t});\r\n\t\t}\r\n\t}])\r\n})();\n(function(){\r\n\tapp.controller('overviewsCtrl', ['$scope', \r\n\t\t'meanData', function($scope, meanData){\r\n\r\n\t\t\r\n\t\t\r\n\t}])\r\n})();\n(function(){\r\n\tapp.controller('settingsCtrl', ['$scope', 'meanData',\r\n\t\t\t\t'$state', function($scope, meanData, $state){\r\n\r\n\t\t$scope.backupDB = function(){\r\n\t\t\tmeanData.doDBBackup().then(function(res){\r\n\t\t\t\talert(res.data.message);\r\n\t\t\t\t$state.reload();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$scope.getSettings = function(){\r\n\t\t\tmeanData.getSettings().then(function(res){\r\n\t\t\t\tif(res.length > 1){\r\n\t\t\t\t\talert(\"More than one settings found!\");\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\t$scope.settings = res.data[0];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$scope.updateSettings = function(settings){\r\n\t\t\tmeanData.updateSettings(settings).then(function(res){\r\n\t\t\t\talert(res.data.message);\r\n\t\t\t\twindow.location.href = \"/admin/settings\";\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$scope.deleteSettings = function(){\r\n\t\t\tmeanData.deleteSettings().then(function(res){\r\n\t\t\t\talert(res.data.message);\r\n\t\t\t});\r\n\t\t}\r\n\t}])\r\n})();\n(function(){\r\n\tapp.controller('usermCtrl', ['$scope', 'meanData',\r\n\t\t'$state', function($scope, meanData, $state){\r\n\t\t\r\n\t\tmeanData.getAllUsers().then(function(res){\r\n\t\t\t$scope.users = res.data;\r\n\t\t});\r\n\r\n\t\t$scope.deleteUser = function(id){\r\n\t\t\tif(confirm(\"Are you sure to delete?\")){\r\n\t\t\t\tmeanData.deleteUser(id).then(function(res){\r\n\t\t\t\t\talert(res.data.message);\r\n\t\t\t\t\t$state.reload();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}])\r\n})();\n(function () {\r\n  app.service('authentication', ['$http', '$window',\r\n       function ($http, $window) {\r\n\r\n    var saveToken = function (token) {\r\n      $window.localStorage['mean-token'] = token;\r\n    };\r\n\r\n    var getToken = function () {\r\n      return $window.localStorage['mean-token'];\r\n    };\r\n\r\n    var isLoggedIn = function () {\r\n      var token = getToken();\r\n      var payload;\r\n\r\n      if(token){\r\n        payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n\r\n        return payload.exp > Date.now() / 1000;\r\n      }else{\r\n        return false;\r\n      }\r\n    };\r\n\r\n    var currentUser = function() {\r\n      if(isLoggedIn()){\r\n        var token = getToken();\r\n        var payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n        \r\n        return {\r\n          _id : payload._id,\r\n          name: payload.name\r\n        };\r\n      }\r\n    };\r\n\r\n    var login = function (user) {\r\n      return $http.post('/api/login', user).then(function (res) {\r\n        saveToken(res.data.token);\r\n      })\r\n    };\r\n\r\n    var logout = function () {\r\n      $window.localStorage.removeItem('mean-token');\r\n    };\r\n\r\n    return {\r\n      login: login,\r\n      isLoggedIn: isLoggedIn,\r\n      currentUser: currentUser,\r\n      logout: logout,\r\n      getToken: getToken\r\n    }\r\n\r\n  }])\r\n  \r\n})();\n(function () {\r\n  app.service('meanData', ['$http', 'authentication',\r\n      function meanData($http, authentication) {\r\n    \r\n    var serverUrl = \"/api\";\r\n    var auth = {\r\n        headers: {\r\n          Authorization: 'Bearer ' + authentication.getToken()\r\n        }\r\n    };\r\n\r\n    /***** User *****/\r\n    var getAllUsers = function () {\r\n      return $http.get(serverUrl + '/user', auth);\r\n    };\r\n\r\n    var getUserById = function (id) {\r\n      return $http.get(serverUrl + '/user/' + id, auth);\r\n    };\r\n\r\n    var createUser = function (newUser) {\r\n      return $http.post(serverUrl + '/user', newUser);\r\n    };\r\n\r\n    var updateUser = function (updateUser) {\r\n      return $http.put(serverUrl + '/user', updateUser, auth);\r\n    };\r\n\r\n    var deleteUser = function (id) {\r\n      return $http.delete(serverUrl + '/user?id=' + id, auth);\r\n    };\r\n\r\n    /***** Log *****/\r\n    var getAllLogs = function(){\r\n      return $http.get(serverUrl + '/log', auth);\r\n    }\r\n\r\n    var getLogsByIp = function(ip){\r\n      return $http.get(serverUrl + '/log?ip=' + ip, auth)\r\n    }\r\n\r\n    var getLogsByDate = function(date){\r\n      return $http.get(serverUrl + '/log?date=' + date, auth);\r\n    }\r\n\r\n    var deleteAllLogs = function(){\r\n      return $http.delete(serverUrl + '/log', auth);\r\n    }\r\n\r\n    /***** Settings *****/\r\n    var getSettings = function(){\r\n      return $http.get(serverUrl + '/settings', auth);\r\n    }\r\n\r\n    var doDBBackup = function(){\r\n      return $http.get(serverUrl + '/settings/dbbu', auth);\r\n    }\r\n\r\n    var updateSettings = function(settings){\r\n      return $http.put(serverUrl + '/settings', settings, auth);\r\n    }\r\n\r\n    var deleteSettings = function(){\r\n      return $http.delete(serverUrl + '/settings', auth);\r\n    }\r\n\r\n    return {\r\n      getAllUsers: getAllUsers,\r\n      createUser: createUser,\r\n      updateUser: updateUser,\r\n      deleteUser: deleteUser,\r\n      getUserById: getUserById,\r\n\r\n      getSettings: getSettings,\r\n      doDBBackup: doDBBackup,\r\n      updateSettings: updateSettings,\r\n      deleteSettings: deleteSettings,\r\n\r\n      getAllLogs: getAllLogs,\r\n      getLogsByIp: getLogsByIp,\r\n      getLogsByDate: getLogsByDate,\r\n      deleteAllLogs: deleteAllLogs,\r\n    }\r\n  }])\r\n})();\n(function () {\r\n  app.directive('navigation', function () {\r\n    return {\r\n      restrict: 'EA',\r\n      templateUrl: '/common/directives/navigation/navigation.view.html'\r\n    }\r\n  });\r\n\r\n  app.controller('navCtrl', ['$scope', '$location', 'authentication', '$state', '$window', '$rootScope',\r\n  function($scope, $location, authentication, $state, $window, $rootScope){\r\n    $scope.logout = function () {\r\n      authentication.logout();\r\n      $window.location.href = \"/\";\r\n    };\r\n    \r\n    // get current user\r\n\t  $scope.currentUser = authentication.currentUser();\r\n\t\r\n    $scope.isLoggedIn = authentication.isLoggedIn();\r\n    $rootScope.isActive = function(viewLocation){\r\n      if(viewLocation === '/')\r\n        return $location.path() === viewLocation;\r\n      return $location.path().indexOf(viewLocation) >= 0;\r\n    };\r\n  }])\r\n})();"]}